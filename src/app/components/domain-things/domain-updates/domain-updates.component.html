<div *ngIf="loading" class="p-progressSpinner"></div>
<div *ngIf="!loading && (updates$ | async) as updates">
  <div class="flex flex-col gap-1">
    @for (update of updates; track update.id) {
      <div class="flex flex-row gap-2">
          <p class="m-0">
            @if (update.change_type === 'added') {
              <i pTooltip="Addition" class="pi pi-plus text-green-700 mx-2"></i>
            } @else if (update.change_type === 'removed') {
              <i pTooltip="Removal" class="pi pi-minus text-red-700 mx-2"></i>
            } @else {
              <i pTooltip="Update" class="pi pi-pencil text-blue-700 mx-2"></i>
            }
          </p>
          <p class="m-0">{{ formatDate(update.date) }}</p> -
          @if (!domainName) {
            <a class="m-0 text-default" [routerLink]="'/domains/'+update.domains.domain_name">{{ update.domains.domain_name }}</a>
            -
          }
          @if (update.old_value && update.new_value) {
            <p class="m-0 flex gap-2">
              <span class="text-blue-400">{{ mapChangeKey(update.change) }} updated</span>
              from
              <span class="font-mono">{{ update.old_value || 'N/A' }}</span>
              to
              <span class="font-mono">{{ update.new_value || 'N/A' }}</span>
            </p>
          } @else if (update.new_value) {
            <p class="m-0 flex gap-2">
              <span class="text-green-400">{{ mapChangeKey(update.change) }} added</span>
              <span class="font-mono">{{ update.new_value || 'N/A' }}</span>
            </p>
          } @else if (update.old_value) {
            <p class="m-0 flex gap-2">
              <span class="text-red-400">{{ mapChangeKey(update.change) }} removed</span>
              <span class="font-mono">{{ update.old_value || 'N/A' }}</span>
            </p>
          }
      </div>
    }
  </div>
  <div *ngIf="updates.length === 0">
    <p class="my-4 text-2xl text-center italic text-surface-400">
      <i class="pi pi-info-circle text-2xl mr-2"></i>
      No updates recorded yet
    </p>
  </div>
</div>

<p-paginator
  styleClass="mt-4 border-0"
  [rows]="25"
  [totalRecords]="totalRecords"
  [rowsPerPageOptions]="[25, 50, 100]"
  (onPageChange)="onPageChange($event)"
></p-paginator>


<h1 class="mb-4">Status Page</h1>
<p>
  We're actively monitoring the status of our services and all third-party integrations we rely upon,
  in order to ensure the best possible experience for our users.<br>
  This page provides live information about the current state of our service, as well as a log of any ongoing incidents or scheduled maintenance.
</p>

<div class="p-card px-4 py-3">

</div>

<div *ngIf="statusInfo$ | async as statusInfo; else loading" class="flex flex-col gap-4 mt-4">

  <!-- Current Status -->
  <div class="p-card px-4 py-3">
    <h2 class="mb-4">Current Service Status</h2>

    <h3>Domain Locker Internal</h3>


    <h3>Third-Party Services</h3>
    <div class="flex flex-col">
      <div *ngFor="let item of statusInfo.summary" class="flex flex-col sm:flex-row mb-1">
        <div class="flex-shrink-0 w-32 flex items-center space-x-2">
          <app-domain-favicon *ngIf="item.serviceMeta" [domain]="item.serviceMeta.upstreamSite || item.serviceMeta.url" [size]="20" />
          <span class="font-semibold">{{ item.service }}</span>
        </div>
        <div class="flex-grow">
          <i class="pi pi-circle" [ngClass]="{
            'text-red-500 pi-times-circle': item.status === 'critical',
            'text-yellow-500 pi-exclamation-circle': item.status === 'minor',
            'text-blue-500 pi-info-circle': item.status === 'info',
            'text-green-500 pi-check-circle': item.status === 'operational',
            'text-gray-500 pi-minus-circle': item.status === 'unknown'
          }"></i>
          {{ item.details }}
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Incidents -->
  <div class="p-card px-4 py-3">
    <h2>Recent Incidents</h2>
    <ul class="list-none p-0 h-96 overflow-y-auto">
      <li
        *ngFor="let item of statusInfo.history"
        class="flex items-between sm:items-center gap-1 sm:gap-2 mb-1 flex-col sm:flex-row">
        <span class="flex-shrink-0 whitespace-nowrap">
          <i class="pi pi-circle" [ngClass]="{
            'text-red-500 pi-times-circle': item.severity === 'critical',
            'text-yellow-500 pi-exclamation-circle': item.severity === 'minor',
            'text-blue-500 pi-info-circle': item.severity === 'info',
            'text-green-500 pi-check-circle': item.severity === 'operational',
            'text-gray-500 pi-minus-circle': item.severity === 'unknown'
          }"></i>
          {{ item.date | date:"d MMM 'at' HH:mm" }}
        </span>
        <span class="flex-shrink-0 whitespace-nowrap font-semibold">
          <app-domain-favicon *ngIf="item.serviceMeta"
            [domain]="item.serviceMeta.upstreamSite || item.serviceMeta.url"
            [size]="16"
          />
          {{ item.service }}:
        </span>
        <span class="flex-grow min-w-0 truncate">
          {{ item.details }}
        </span>
        <a class="flex-shrink-0 px-[0.25rem] py-[0.1rem] rounded sm:flex-row transition-all hover:bg-surface-100" [href]="item.link" target="_blank">
          Details ↪
        </a>
        <p-divider class="block sm:hidden" [style]="{ 'flex-grow': '1' }"></p-divider>
      </li>
    </ul>
  </div>
  
  <!-- Upcoming maintenon with third-parties -->
  <div class="p-card px-4 py-3">
    <h2>Scheduled Disruptions</h2>
    <ul class="list-none p-0 h-96 overflow-y-auto">
      <li *ngFor="let item of statusInfo.scheduled" class="flex items-between sm:items-center gap-1 sm:gap-2 mb-1 flex-col sm:flex-row">
        <span class="flex-shrink-0 whitespace-nowrap">
          {{ item.date | date:"d MMM 'at' HH:mm" }}
        </span>
        <span class="flex-shrink-0 whitespace-nowrap font-semibold">
          <app-domain-favicon *ngIf="item.serviceMeta"
            [domain]="item.serviceMeta.upstreamSite || item.serviceMeta.url"
            [size]="16"
          />
          {{ item.service }}:
        </span>
        <span class="flex-grow min-w-0 truncate">
          {{ item.details }}
        </span>
        <a class="flex-shrink-0" [href]="item.link" target="_blank">
          Details ↪
        </a>
        <p-divider class="block sm:hidden" [style]="{ 'flex-grow': '1' }"></p-divider>
      </li>
    </ul>
  </div>
  
</div>
<ng-template #loading>
  <p>Loading status info...</p>
</ng-template>

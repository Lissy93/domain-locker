
<div class="flex items-center justify-between">
  <h1 class="m-0">Links</h1>
  <p-selectButton 
    [options]="displayByOptions" 
    [(ngModel)]="displayBy" 
    optionLabel="label" 
    optionValue="value"
  />
</div>

<!-- {{ links | json }} -->

<!-- "groupedByDomain":
 { "microsoft.com": [
  { "link_name": "Another link", "link_url": "https://google.com/", "link_description": null },
  { "link_name": "Alicia", "link_url": "https://as93.net/", "link_description": "AS93" },
  { "link_name": "Some Link", "link_url": "https://example.com/", "link_description": "Test for Example" }
]}, -->

<p-contextMenu #menu [model]="contextMenuItems" appendTo="body"></p-contextMenu>

@if (displayBy === 'all-links' && links?.linksWithDomains?.length) {
  <ul class="list-none p-0 m-0 mt-4 grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3">
    <li *ngFor="let link of links?.linksWithDomains" class="w-full flex">
      <a
        [href]="link.link_url"
        target="_blank"
        (contextmenu)="onRightClick($event, link)"
        class="p-card px-3 py-2 flex flex-col gap-1 w-full no-underline justify-between"
      >
        <h3 class="flex gap-2 m-0 text-lg font-semibold">
          <app-domain-favicon [domain]="link.link_url" [size]="24" />
          {{ link.link_name }}
        </h3>
        <p *ngIf="link.link_description" class="m-0 italic">{{ link.link_description }}</p>

        <p class="m-0 text-sm text-gray-500">
          @if (link.domains.length === 1) {
            Associated with {{ link.domains[0] }}
          } @else {
            Associated with {{ link.domains.length }} domains
          }
        </p>
      </a>
    </li>
  </ul>
}

@if (displayBy === 'by-domain') {
  <div *ngFor="let domain of links?.groupedByDomain | keyvalue" class="mt-4">
    <a [routerLink]="'/domains/' + domain.key" class="no-underline text-default hover:text-primary">
      <h2 class="mt-3 mb-2">{{ domain.key }}</h2>
    </a>
    <ul class="list-none p-0 m-0 grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3">
      <li *ngFor="let link of domain.value" class="w-full flex">
        <a
          [href]="link.link_url"
          target="_blank"
          (contextmenu)="onRightClick($event, link)"
          class="p-card px-3 py-2 flex flex-col gap-1 w-full no-underline justify-between"
        >
          <h3 class="flex gap-2 my-0 text-lg font-semibold">
            <app-domain-favicon [domain]="link.link_url" [size]="24" />
            {{ link.link_name }}
          </h3>
          <p *ngIf="link.link_description" class="m-0 italic">{{ link.link_description }}</p>
        </a>
      </li>
    </ul>
  </div>
}

<!-- <p-contextMenu [target]="domainCard" [model]="contextMenuItems" /> -->
